{% extends "base/base.html" %}
{% load static i18n socialaccount %}
{% block title %}{% translate "t_page_title" %}{% endblock %}

{% block content %}

<!-- Testing change Language -->
<form action="{% url 'set_language' %}" method="post">{% csrf_token %}
    <input name="next" type="hidden" value="{{ redirect_to }}">
    <select name="language">
        {% get_current_language as LANGUAGE_CODE %}
        {% get_available_languages as LANGUAGES %}
        {% get_language_info_list for LANGUAGES as languages %}
        {% for language in languages %}
            <option value="{{ language.code }}"{% if language.code == LANGUAGE_CODE %} selected{% endif %}>
                {{ language.name_local }} ({{ language.code }})
            </option>
        {% endfor %}
    </select>
    <input type="submit" value="Go">
</form>

<!-- LOG IN AND WELCOME TEXT -->
<section class="mt-4 flex justify-center">
  <div id="client-card" class="z-10 w-4/5  bg-white bg-opacity-90 rounded-lg shadow-md hidden">
    <h2 class="px-6 pt-6 text-xl font-bold">
      {% translate 'client_card_text_title' %}
    </h2>
    <div class="p-6 max-h-64 flex flex-col text-sm text-gray-900 text-justify overflow-auto">
      {% autoescape off %}{% translate 'client_card_text' %}{% endautoescape %}
    </div>
    <div class="px-3 py-2 flex justify-center items-center rounded-b-lg">
      <!-- GOOGLE LOGIN -->
      <button type="button"
        class="text-white bg-[#4285F4] hover:bg-[#4285F4]/90 focus:ring-4 focus:outline-none focus:ring-[#4285F4]/50 font-medium rounded-lg text-md px-5 py-2.5 text-center inline-flex items-center dark:focus:ring-[#4285F4]/55 mr-2 mb-2">
        <svg class="w-4 h-4 mr-2 -ml-1" aria-hidden="true" focusable="false" data-prefix="fab" data-icon="google"
          role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 488 512">
          <path fill="currentColor"
            d="M488 261.8C488 403.3 391.1 504 248 504 110.8 504 0 393.2 0 256S110.8 8 248 8c66.8 0 123 24.5 166.3 64.9l-67.5 64.9C258.5 52.6 94.3 116.6 94.3 256c0 86.5 69.1 156.6 153.7 156.6 98.2 0 135-70.4 140.8-106.9H248v-85.3h236.1c2.3 12.7 3.9 24.9 3.9 41.4z">
          </path>
        </svg>
        {% translate 't_login_with_google' %}
      </button>
      <!-- End Login -->
    </div>
  </div>

  <div id="partner-card" class="z-10 w-4/5  bg-white bg-opacity-90 rounded-lg shadow-md hidden">
    <h2 class="px-6 pt-6 text-xl font-bold">
      {% translate 'partner_card_text_title' %}
    </h2>
    <div class="p-6 max-h-64 flex flex-col text-sm text-gray-900 text-justify overflow-auto">
      {% autoescape off %}{% translate 'partner_card_text'%}{% endautoescape %}
    </div>
    <div class="px-3 py-2 flex justify-center items-center rounded-b-lg">
      <!-- PARTNER Login -->
      <button type="button"
        class="text-white bg-[#4285F4] hover:bg-[#4285F4]/90 focus:ring-4 focus:outline-none focus:ring-[#4285F4]/50 font-medium rounded-lg text-md px-5 py-2.5 text-center inline-flex items-center dark:focus:ring-[#4285F4]/55 mr-2 mb-2">
        <span class="">{% translate 'register_button' %}</span>
      </button>
      <!-- End Login -->
    </div>
  </div>


  <!-- Floating Buttons -->
  <div class="fixed bottom-0 left-0 right-0 flex justify-center mb-16">
    <button id="client-button" onclick="showCard('client')"
      class="bg-sky-200 hover:bg-sky-900 text-sky-900 hover:text-white font-bold py-2 px-4 rounded-l-full">
      {% translate 'i_am_client_button' %}
    </button>
    <button id="partner-button" onclick="showCard('partner')"
      class="bg-sky-200 hover:bg-sky-900 text-sky-900 hover:text-white font-bold py-2 px-4 rounded-r-full">
      {% translate 'i_am_partner_button' %}
    </button>
  </div>
</section>


<!-- Keep background video and placeholder at bottom -->
<video class="video-background" id="video" loop muted playsinline> {# autoplay commented!!!!!!!! #}
  <source src="{% static 'videos_background/vid_bg.mp4' %}" type="video/mp4">
</video>
<img class="video-placeholder video-background" src="{% static 'videos_background/video_placeholder.png' %}"
  alt="Video Placeholder">
{% endblock %}


{% block scripts %}
<script>
  function showCard(tipo) {
    var clientButton = document.getElementById('client-button');
    var partnerButton = document.getElementById('partner-button');

    // shame on me... there's a better way with Tailwind AND javascript... TODO

    if (tipo === 'client') {
      console.log('client')
      document.getElementById('client-card').style.display = 'block';
      document.getElementById('partner-card').style.display = 'none';
      // Add active class to client button
      clientButton.classList.add('bg-sky-900', 'text-white');
      clientButton.classList.remove('bg-sky-200', 'text-sky-900');
      partnerButton.classList.add('bg-sky-200', 'text-sky-900');
      partnerButton.classList.remove('bg-sky-900', 'text-white');
    } else if (tipo === 'partner') {
      console.log('partner')
      document.getElementById('client-card').style.display = 'none';
      document.getElementById('partner-card').style.display = 'block';
      // Add active class to partner button
      partnerButton.classList.add('bg-sky-900', 'text-white');
      partnerButton.classList.remove('bg-sky-200', 'text-sky-900');
      clientButton.classList.add('bg-sky-200', 'text-sky-900');
      clientButton.classList.remove('bg-sky-900', 'text-white');
    }
  }
</script>
<script>
  // Wait for the page to load then start the bg video
  document.addEventListener('DOMContentLoaded', function () {
    var video = document.getElementById('video');

    video.addEventListener('canplaythrough', function () {
      var videoPlaceholder = document.querySelector('.video-placeholder');
      videoPlaceholder.style.display = 'none';
      console.log("Playing video... Sorry dude, but art mater... :)")


      // Function to pause the video at random (1% each 1000 ms)
      function pauseVideo() {
        if (Math.random() < 0.0001) {
          video.pause();
          console.log("Video paused randomly.");
        }
      }

      setInterval(pauseVideo, 1000);

    });
  });
</script>
{% endblock %}