{% load static socialaccount i18n %}
{% get_current_language as LANGUAGE_CODE %}
{% get_available_languages as LANGUAGES %}
{% get_language_info_list for LANGUAGES as languages %}

<nav class="
            -z-10
            flex
            w-full
            h-28
            justify-between
            bg-gradient-to-b from-sky-200 to-transparent
            ">

  <!-- Logo Circle -->
  <div class="
              flex
              h-20 min-h-fit
              {% if user.is_authenticated %}
              w-20 min-w-20 
              {% else %}
              w-32 min-w-32 
              {% endif %}
              mt-4
              bg-sky-900 
              rounded-r-full 
              ">
    <a class="flex ml-auto" href="{% url 'home' %}">
      <img class="rounded-full m-1" src="{% static 'images/logo_km1151.png' %}" alt="Site Logo">
    </a>
  </div>

  <!-- Title -->
  {% if user.is_authenticated %}
  <div></div>
  {% else %}
  <div class="
              flex
              mt-4
              h-20 
              items-center
              text-center
              drop-shadow
              ">
    <span class="
                 font-quicksand
                 font-bold
                 text-white
                 sm:text-6xl
                 text-4xl
                 traslate-y-2
                 drop-shadow-md
                 sm:whitespace-nowrap
                 ">
      {% translate 't_page_title' %}</span>
  </div>
  {% endif %}

  <!-- Avatar Circle -->
  <div class="
              flex
              mt-4
              h-20
              {% if user.is_authenticated %}
              w-20 min-w-20 
              {% else %}
              w-32 min-w-32 
              {% endif %}
              bg-sky-900
              rounded-l-full 
              ">
    <div class="flex mr-auto p-1 drop-shadow-sm">
      {% if user.is_authenticated %}
      {% with provider_id=user.socialaccount_set.all.0.get_provider.id %}
      {% if provider_id == 'google' %}
      <a class="flex" href="{% url 'user_home' %}">
        <img class="rounded-full border-4 border-white" src="{{ user.socialaccount_set.all.0.get_avatar_url }}" />
      </a>
      {% endif %}
      {% endwith %}
      {% else %}

      <!-- SHOWS CIRCULAR FLAGS AND CHANGE LANGUAGE ON CLICK -->
      <form id="language-form-{{ language.code }}" action="{% url 'set_language' %}" method="post">{% csrf_token %}
        <input name="next" type="hidden" value="{{ redirect_to }}">
        {% if LANGUAGE_CODE == 'es' %}
        <input name="language" type="hidden" value="pt">
        {% elif LANGUAGE_CODE == 'pt' %}
        <input name="language" type="hidden" value="en">
        {% else %}
        <input name="language" type="hidden" value="es">
        {% endif %}
        <button class="h-full w-full" type="submit" form="language-form-{{ language.code }}">
          <img class="rounded-full border-4 border-white h-full aspect-square object-cover"
            src="{% static 'images/languages/'|add:LANGUAGE_CODE|add:'.svg' %}" />
        </button>
      </form>
      {% endif %}
    </div>

    <!-- Ticket -->
    <div class="
              fixed
              right-0
              top-44
              flex
              h-14 min-h-fit
              w-14 min-w-14 
              bg-sky-900 
              rounded-l-full 
              ">
      <a class="flex ml-auto p-1 drop-shadow-sm" href="{% url 'tickets' %}">
        <!-- Ticket svg -->
        <svg class="p-2" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" fill="#000000">
          <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
          <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
          <g id="SVGRepo_iconCarrier">
            <path
              d="M2 5C.892 5 0 5.892 0 7v7c0 1.108.892 2 2 2h9c1.108 0 2-.892 2-2v-3.8L16 7h-3c0-1.108-.892-2-2-2zm4.438 2C7.75 6.926 8.926 7.936 9 9.25c0 1.121-.308 1.544-1.281 2.281a1.68 1.68 0 00-.281.25c-.04.05-.032.033-.032.031.006.423-.39.782-.812.782a.79.79 0 01-.781-.782c0-.401.179-.754.375-1a3.14 3.14 0 01.562-.562 3.85 3.85 0 00.563-.531c.074-.09.097-.24.093-.344v-.031a.785.785 0 00-.843-.75c-.451.025-.813.362-.851.758a.697.697 0 01-.718.648.816.816 0 01-.781-.594 1.725 1.725 0 01.01-.533c.005-.014.006-.03.012-.043.202-1.024 1.09-1.768 2.203-1.83zm.156 6.406a.82.82 0 01.812.813c0 .442-.37.781-.812.781a.768.768 0 01-.781-.781c0-.442.339-.813.78-.813zM2 1C.892 1 0 1.892 0 3v.568A3.918 3.918 0 012 3h9c1.376 0 2.55.763 3.268 1.848L16 3h-3c0-1.108-.892-2-2-2z"
              fill="#ffffff"></path>
          </g>
        </svg>
      </a>
    </div>


    <!-- RIGHT SIDE (Flag, Exit) -->
    {% if user.is_authenticated %}

    <div class="
    fixed
    top-28
    right-0
    flex
    h-14
    w-14 min-w-14 
    bg-sky-900
    rounded-l-full 
    ">
      <div class="flex mr-auto p-1 drop-shadow-sm">
        <a class="flex" href="#">
          <!-- SHOWS CIRCULAR FLAGS AND CHANGE LANGUAGE ON CLICK -->
          <form id="language-form-{{ language.code }}" action="{% url 'set_language' %}" method="post">{% csrf_token %}
            <input name="next" type="hidden" value="{{ redirect_to }}">
            {% if LANGUAGE_CODE == 'es' %}
            <input name="language" type="hidden" value="pt">
            {% elif LANGUAGE_CODE == 'pt' %}
            <input name="language" type="hidden" value="en">
            {% else %}
            <input name="language" type="hidden" value="es">
            {% endif %}
            <button class="h-full w-full" type="submit" form="language-form-{{ language.code }}">
              <img class="rounded-full border-4 border-white h-full aspect-square object-cover"
                src="{% static 'images/languages/'|add:LANGUAGE_CODE|add:'.svg' %}" />
            </button>
          </form>
        </a>
      </div>
    </div>
    <div class="
    fixed
    top-60
    right-0
    flex
    h-14
    w-14 min-w-14 
    bg-sky-900
    rounded-l-full 
              ">
      <div class="flex mr-auto p-1 drop-shadow-sm">
        <a class="flex" href="{% url 'logout' %}">
          <svg class="p-2" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
            <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
            <g id="SVGRepo_iconCarrier">
              <path fill-rule="evenodd" clip-rule="evenodd"
                d="M21.593 10.943c.584.585.584 1.53 0 2.116L18.71 15.95c-.39.39-1.03.39-1.42 0a.996.996 0 0 1 0-1.41 9.552 9.552 0 0 1 1.689-1.345l.387-.242-.207-.206a10 10 0 0 1-2.24.254H8.998a1 1 0 1 1 0-2h7.921a10 10 0 0 1 2.24.254l.207-.206-.386-.241a9.562 9.562 0 0 1-1.69-1.348.996.996 0 0 1 0-1.41c.39-.39 1.03-.39 1.42 0l2.883 2.893zM14 16a1 1 0 0 0-1 1v1.5a.5.5 0 0 1-.5.5h-7a.5.5 0 0 1-.5-.5v-13a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 .5.5v1.505a1 1 0 1 0 2 0V5.5A2.5 2.5 0 0 0 12.5 3h-7A2.5 2.5 0 0 0 3 5.5v13A2.5 2.5 0 0 0 5.5 21h7a2.5 2.5 0 0 0 2.5-2.5V17a1 1 0 0 0-1-1z"
                fill="#ffffff"></path>
            </g>
          </svg>
        </a>
      </div>
    </div>

    <!-- LEFT SIDE (Menu, Opt1, Opt2, ...) -->

    <!-- Sandwitch -->
    <div class="
    fixed
    left-0
    flex
    h-14 min-h-fit
    w-14 min-w-14 
    top-28
    bg-sky-900 
    rounded-r-full 
    ">
      <a class="flex ml-auto p-1 drop-shadow-sm" href="{% url 'company' %}">
        <!-- sandwitch svg -->
        <svg class="p-2" version="1.1" id="_x32_" xmlns="http://www.w3.org/2000/svg"
          xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 512 512" xml:space="preserve" fill="#000000">
          <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
          <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
          <g id="SVGRepo_iconCarrier">
            <style type="text/css">
              .st0 {
                fill: #ffffff;
              }
            </style>
            <g>
              <path class="st0"
                d="M277.028,262.753l-26.612-2.882c-3.641-0.394-6.72-2.788-8.118-6.172c-0.017-0.04-0.034-0.081-0.05-0.121 c-1.403-3.383-0.92-7.252,1.376-10.105l16.78-20.855c3.164-3.932,2.857-9.616-0.712-13.185l-31.411-31.411 c-3.569-3.569-9.252-3.876-13.185-0.712l-20.864,16.787c-2.846,2.29-6.704,2.776-10.082,1.386c-0.037-0.015-0.074-0.03-0.111-0.045 c-3.396-1.394-5.799-4.478-6.194-8.128l-2.883-26.624c-0.543-5.018-4.779-8.82-9.826-8.82h-44.422c-5.047,0-9.283,3.802-9.826,8.82 l-2.883,26.624c-0.395,3.649-2.799,6.734-6.195,8.128c-0.037,0.015-0.074,0.03-0.11,0.045c-3.378,1.391-7.236,0.904-10.082-1.386 L70.752,177.31c-3.932-3.164-9.616-2.857-13.184,0.712l-31.411,31.411c-3.569,3.569-3.876,9.253-0.712,13.185l16.78,20.855 c2.296,2.854,2.779,6.722,1.376,10.105c-0.017,0.04-0.033,0.081-0.05,0.121c-1.399,3.384-4.477,5.778-8.118,6.172L8.82,262.753 C3.802,263.296,0,267.532,0,272.579v44.422c0,5.047,3.802,9.283,8.82,9.826l26.612,2.881c3.641,0.394,6.72,2.788,8.118,6.172 c0.017,0.04,0.033,0.081,0.05,0.121c1.403,3.383,0.92,7.252-1.376,10.106l-16.78,20.855c-3.164,3.932-2.857,9.616,0.712,13.185 l31.411,31.411c3.569,3.569,9.253,3.876,13.185,0.712l20.864-16.787c2.846-2.291,6.704-2.777,10.082-1.386 c0.037,0.015,0.074,0.03,0.111,0.045c3.396,1.394,5.799,4.478,6.194,8.128l2.883,26.624c0.543,5.018,4.779,8.82,9.826,8.82h44.422 c5.047,0,9.283-3.802,9.826-8.82l2.883-26.624c0.395-3.649,2.798-6.734,6.194-8.128c0.037-0.015,0.074-0.03,0.11-0.045 c3.378-1.391,7.236-0.905,10.083,1.386l20.864,16.787c3.932,3.164,9.616,2.857,13.185-0.712l31.411-31.411 c3.569-3.569,3.875-9.253,0.712-13.185l-16.78-20.855c-2.296-2.853-2.779-6.722-1.376-10.106c0.016-0.04,0.033-0.08,0.05-0.121 c1.399-3.384,4.477-5.778,8.118-6.172l26.612-2.881c5.017-0.544,8.82-4.78,8.82-9.826v-44.422 C285.848,267.532,282.046,263.296,277.028,262.753z M142.924,339.349c-24.609,0-44.559-19.95-44.559-44.559 c0-24.609,19.95-44.559,44.559-44.559s44.559,19.95,44.559,44.559C187.483,319.399,167.533,339.349,142.924,339.349z">
              </path>
              <path class="st0"
                d="M507.469,218.212L489.2,203.785c-2.91-2.298-4.526-5.821-4.528-9.53c0-0.039,0-0.078,0-0.118 c-0.006-3.717,1.611-7.249,4.528-9.552l18.269-14.428c4.184-3.304,5.664-8.985,3.624-13.91l-8.025-19.374 c-2.04-4.926-7.104-7.896-12.398-7.274l-23.12,2.716c-3.692,0.434-7.333-0.92-9.956-3.553c-0.027-0.028-0.055-0.056-0.083-0.083 c-2.622-2.624-3.97-6.258-3.537-9.941l2.716-23.119c0.622-5.294-2.349-10.358-7.274-12.398l-19.374-8.024 c-4.925-2.04-10.606-0.56-13.91,3.623l-14.428,18.268c-2.299,2.911-5.822,4.526-9.53,4.528c-0.04,0-0.079,0-0.118,0 c-3.716,0.006-7.248-1.611-9.552-4.528l-14.428-18.269c-3.304-4.184-8.986-5.664-13.911-3.624l-19.374,8.025 c-4.925,2.04-7.896,7.104-7.274,12.399l2.716,23.12c0.434,3.691-0.92,7.332-3.553,9.956c-0.028,0.028-0.056,0.056-0.084,0.084 c-2.624,2.622-6.257,3.97-9.941,3.537l-23.119-2.716c-5.295-0.622-10.358,2.349-12.398,7.274l-8.025,19.374 c-2.04,4.925-0.56,10.607,3.624,13.911l18.268,14.427c2.911,2.299,4.526,5.821,4.528,9.53c0,0.04,0,0.079,0,0.118 c0.007,3.717-1.611,7.249-4.528,9.552l-18.269,14.428c-4.184,3.304-5.664,8.985-3.623,13.91l8.024,19.374 c2.04,4.925,7.104,7.896,12.398,7.274l23.121-2.716c3.691-0.434,7.332,0.92,9.956,3.553c0.028,0.028,0.055,0.056,0.083,0.083 c2.622,2.624,3.97,6.257,3.537,9.941l-2.716,23.12c-0.622,5.295,2.349,10.358,7.274,12.398l19.374,8.025 c4.925,2.04,10.606,0.56,13.911-3.624l14.427-18.268c2.299-2.911,5.821-4.526,9.53-4.528c0.039,0,0.078,0,0.118,0 c3.716-0.007,7.249,1.611,9.552,4.528l14.428,18.269c3.304,4.184,8.985,5.664,13.911,3.624l19.374-8.025 c4.925-2.04,7.896-7.104,7.274-12.398l-2.716-23.12c-0.434-3.691,0.92-7.333,3.553-9.956c0.028-0.028,0.056-0.056,0.084-0.083 c2.624-2.621,6.257-3.97,9.941-3.537l23.12,2.716c5.295,0.622,10.358-2.349,12.398-7.274l8.025-19.374 C513.132,227.198,511.653,221.516,507.469,218.212z M403.948,228.701c-18.584,7.698-39.89-1.127-47.588-19.712 s1.128-39.89,19.712-47.588c18.584-7.698,39.89,1.127,47.588,19.712C431.357,199.697,422.532,221.004,403.948,228.701z">
              </path>
            </g>
          </g>
        </svg>
      </a>
    </div>

    <!-- Truck -->
    <div class="
  fixed
  left-0
  flex
  h-14 min-h-fit
  w-14 min-w-14 
  top-44
  bg-sky-900 
  rounded-r-full 
  ">
      <a class="flex ml-auto p-1 drop-shadow-sm" href="{% url 'vehicles' %}">
        <!-- Truck svg -->
        <svg class="p-2" fill="#ffffff" viewBox="0 -30.87 122.88 122.88" version="1.1" id="Layer_1"
          xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
          style="enable-background:new 255 0 122.88 61.14" xml:space="preserve">
          <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
          <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
          <g id="SVGRepo_iconCarrier">
            <style type="text/css">
              .st0 {
                fill-rule: evenodd;
                clip-rule: evenodd;
              }
            </style>
            <g>
              <path class="st0"
                d="M105.01,40.54c-5.7,0-10.3,4.63-10.3,10.3c0,5.7,4.63,10.3,10.3,10.3c5.7,0,10.3-4.63,10.3-10.3 C115.31,45.14,110.68,40.54,105.01,40.54L105.01,40.54z M61.86,41.46c-5.2,0-9.38,4.22-9.38,9.38c0,5.2,4.22,9.38,9.38,9.38 c5.2,0,9.38-4.22,9.38-9.38C71.24,45.64,67.02,41.46,61.86,41.46L61.86,41.46z M61.86,47.23c-1.99,0-3.61,1.62-3.61,3.61 s1.62,3.61,3.61,3.61c1.99,0,3.61-1.62,3.61-3.61S63.85,47.23,61.86,47.23L61.86,47.23z M24.11,41.46c-5.2,0-9.38,4.22-9.38,9.38 c0,5.2,4.22,9.38,9.38,9.38c5.2,0,9.38-4.22,9.38-9.38C33.5,45.64,29.28,41.46,24.11,41.46L24.11,41.46z M24.11,47.23 c-1.99,0-3.61,1.62-3.61,3.61s1.62,3.61,3.61,3.61c1.99,0,3.61-1.62,3.61-3.61S26.11,47.23,24.11,47.23L24.11,47.23z M47.37,53.53 H38.1v-3.01h9.27V53.53L47.37,53.53z M10.46,53.53H5.63c-1.55,0-2.95-0.66-3.96-1.71c-1.01-1.05-1.65-2.5-1.65-4.02V8.06 c0-2.44-0.36-4.44,1.62-6.42C2.66,0.63,4.05,0,5.6,0h73.32c1.55,0,2.95,0.63,3.96,1.65c1.01,1.01,1.65,2.41,1.65,3.96l0,7.26 l10.27,0.07l3.62,0.02l0,0c0.73,0.79,1.4,1.6,2.01,2.42c2.71,3.64,4.23,7.94,4.52,12.11l16.38,6.27l1.55,16.51h-5.01 c-2.31-18.03-25.03-15.84-25.73,0l-7.61,0v1.74c0,0.86-0.67,1.52-1.52,1.52l-6.69,0v-3.04h5.16V5.61c0-0.7-0.28-1.33-0.76-1.81 c-0.48-0.48-1.11-0.76-1.81-0.76H5.6c-0.7,0-1.33,0.29-1.81,0.76C2.76,4.77,3.07,6.43,3.07,7.7v40.1c0,0.73,0.32,1.43,0.79,1.93 c0.48,0.48,1.08,0.79,1.77,0.79h4.82V53.53L10.46,53.53z M94.46,17.89l-5.83-0.09v9.69h11.02C99.12,23.98,97.49,20.9,94.46,17.89 L94.46,17.89z M105.01,46.88c-2.19,0-3.96,1.77-3.96,3.96c0,2.19,1.77,3.96,3.96,3.96c2.19,0,3.96-1.77,3.96-3.96 C108.97,48.65,107.2,46.88,105.01,46.88L105.01,46.88z">
              </path>
            </g>
          </g>
        </svg>
      </a>
    </div>

    <!-- Fuel -->
    <div class="
    fixed
    left-0
    flex
    h-14 min-h-fit
    w-14 min-w-14 
    top-60
    bg-sky-900 
    rounded-r-full 
    ">
      <a class="flex ml-auto p-1 drop-shadow-sm" href="{% url 'orders' %}">
        <!-- fuel svg -->
        <svg class="p-2" fill="#ffffff" viewBox="0 -29 122.88 122.88" version="1.1" id="Layer_1"
          xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
          style="enable-background:new 0 0 122.88 64.87" xml:space="preserve">
          <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
          <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
          <g id="SVGRepo_iconCarrier">
            <style type="text/css">
              .st0 {
                fill-rule: evenodd;
                clip-rule: evenodd;
              }
            </style>
            <g>
              <path class="st0"
                d="M6.48,10.34C4.99,10.62,3.2,6.72,4.61,6.08c22.22-12.79,24.46-2.2,46.46,2.86l0.28-0.79 c0.7-1.94,0.67-1.34,2.89-0.72l1.07,0.3c3.66,1.02,2.04,0.73,5-1.16C66.99,2.31,77.1,3.3,83.85,7.65c5.85,3.77,6.3,6.93,7.69,13.05 c1.28,5.61,19.56,22.09,31.34,33.11l-5.56,5.78l-7.73-8.05l-7.92,8.71c-2.14,2.35-3.54,4.85-7.06,4.6c-2.38-0.17-8.58-3.74-11-4.94 l-10.13-5.03c-1.82-1.73-2.68-3.98-2.5-6.81c-2.65,0.34-4.93-0.29-6.87-1.84c-6.98-5.57-3.33-9.32-4.3-15.42 c-0.07-0.42-0.15-0.85-0.26-1.27c-1.58-6.4-5.08-8.43-10.19-10.77c-1.62-0.74-1.45-0.35-0.83-2.03l0.25-0.68 C29.65,11.09,25.52,1.22,6.48,10.34L6.48,10.34z M4.04,10.16c1.01,4.47,4.04,6.7,4.04,8.93c0,2.23-1.01,4.47-4.04,4.47 C1.01,23.56,0,21.33,0,19.09C0,16.86,3.03,14.63,4.04,10.16L4.04,10.16z M77.87,41.66c0.36-1.19,0.21-2.54-0.9-3.61l4.29-3.59 c1.67-1.19,3.54-1.74,5.65-1.48c5.76,0.71,14.38,10.65,18.82,14.73l-8.59,9.72C92.13,50.22,86.47,40.79,77.87,41.66L77.87,41.66z M76.24,46.45c0.49-0.35,1.07-0.51,1.75-0.48l4.15,7.72C80.1,53.03,71.85,49.62,76.24,46.45L76.24,46.45z M81.53,45.17 c2.98,1.46,7.29,6.6,11.54,12.06c0.79,0.64-0.1,2.51-2.09,0.97l-2.61-1.39C83.54,54.08,82.99,51.5,81.53,45.17L81.53,45.17z">
              </path>
            </g>
          </g>
        </svg>
      </a>
    </div>
    {% endif %}
</nav>

<!-- ciclo por los language.code y cuando encuentre el código: si es el 'ultimo' poner el primero, si no, index+1 -->

{% block scripts %}
{% endblock %}