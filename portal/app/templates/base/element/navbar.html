{% load static socialaccount i18n %}
{% get_current_language as LANGUAGE_CODE %}
{% get_available_languages as LANGUAGES %}
{% get_language_info_list for LANGUAGES as languages %}

<nav class="
            -z-10
            flex
            w-full
            h-28
            justify-between
            bg-gradient-to-b from-sky-200 to-transparent
            ">

  <!-- Logo Circle -->
  <div class="
              flex
              h-20 min-h-fit
              {% if user.is_authenticated %}
              w-20 min-w-20 
              {% else %}
              w-32 min-w-32 
              {% endif %}
              mt-4
              bg-sky-900 
              rounded-r-full 
              ">
    <a class="flex ml-auto" href="{% url 'home' %}">
      <img class="rounded-full m-1" src="{% static 'images/logo_km1151.png' %}" alt="Site Logo">
    </a>
  </div>

  <!-- Title -->
  {% if user.is_authenticated %}
  <div></div>
  {% else %}
  <div class="
              flex
              mt-4
              h-20 
              items-center
              text-center
              drop-shadow
              ">
    <span class="
                 font-quicksand
                 font-bold
                 text-white
                 sm:text-6xl
                 text-4xl
                 traslate-y-2
                 drop-shadow-md
                 sm:whitespace-nowrap
                 ">
      {% translate 't_page_title' %}</span>
  </div>
  {% endif %}
  <!-- Avatar Circle -->
  <div class="
              flex
              mt-4
              h-20
              {% if user.is_authenticated %}
              w-20 min-w-20 
              {% else %}
              w-32 min-w-32 
              {% endif %}
              bg-sky-900
              rounded-l-full 
              ">
    <div class="flex mr-auto p-1 drop-shadow-sm">
      {% if user.is_authenticated %}
      {% with provider_id=user.socialaccount_set.all.0.get_provider.id %}
      {% if provider_id == 'google' %}
      <a class="flex" href="{% url 'user_home' %}">
        <img class="rounded-full border-4 border-white" src="{{ user.socialaccount_set.all.0.get_avatar_url }}" />
      </a>
      {% endif %}
      {% endwith %}
      {% else %}

      <!-- SHOWS CIRCULAR FLAGS AND CHANGE LANGUAGE ON CLICK -->
      <form id="language-form-{{ language.code }}" action="{% url 'set_language' %}" method="post">{% csrf_token %}
        <input name="next" type="hidden" value="{{ redirect_to }}">
        {% if LANGUAGE_CODE == 'es' %}
        <input name="language" type="hidden" value="pt">
        {% elif LANGUAGE_CODE == 'pt' %}
        <input name="language" type="hidden" value="en">
        {% else %}
        <input name="language" type="hidden" value="es">
        {% endif %}
        <button class="h-full w-full" type="submit" form="language-form-{{ language.code }}">
          <img class="rounded-full border-4 border-white h-full aspect-square object-cover"
            src="{% static 'images/languages/'|add:LANGUAGE_CODE|add:'.svg' %}" />
        </button>
      </form>
      {% endif %}
    </div>

    <!-- RIGHT SIDE (Flag, Exit) -->
    {% if user.is_authenticated %}
    <div class="
              fixed
              top-28
              right-0
              flex
              h-14
              w-14 min-w-14 
              bg-sky-900
              rounded-l-full 
              ">
      <div class="flex mr-auto p-1 drop-shadow-sm">
        <a class="flex" href="#">
          <!-- SHOWS CIRCULAR FLAGS AND CHANGE LANGUAGE ON CLICK -->
          <form id="language-form-{{ language.code }}" action="{% url 'set_language' %}" method="post">{% csrf_token %}
            <input name="next" type="hidden" value="{{ redirect_to }}">
            {% if LANGUAGE_CODE == 'es' %}
            <input name="language" type="hidden" value="pt">
            {% elif LANGUAGE_CODE == 'pt' %}
            <input name="language" type="hidden" value="en">
            {% else %}
            <input name="language" type="hidden" value="es">
            {% endif %}
            <button class="h-full w-full" type="submit" form="language-form-{{ language.code }}">
              <img class="rounded-full border-4 border-white h-full aspect-square object-cover"
                src="{% static 'images/languages/'|add:LANGUAGE_CODE|add:'.svg' %}" />
            </button>
          </form>
        </a>
      </div>
    </div>
    <div class="
              fixed
              top-44
              right-0
              flex
              h-14
              w-14 min-w-14 
              bg-sky-900
              rounded-l-full 
              ">
      <div class="flex mr-auto p-1 drop-shadow-sm">
        <a class="flex" href="{% url 'logout' %}">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="#09406e" stroke-width="1.25"
            stroke-linecap="round">
            <circle cx="12" cy="12" r="12" fill="white" stroke="#09406e"></circle>
            <polyline points="8,16 16,12 8,8" stroke="#09406e"></polyline>
          </svg>
        </a>
      </div>
    </div>

    <!-- LEFT SIDE (Menu, Opt1, Opt2, ...) -->
    <!-- Sandwitch -->
    <div class="
              fixed
              left-0
              flex
              h-14 min-h-fit
              w-14 min-w-14 
              top-28
              bg-sky-900 
              rounded-r-full 
              ">
      <a class="flex ml-auto p-1 drop-shadow-sm" href="#">
        <!-- sandwitch svg -->
        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <circle cx="12" cy="12" r="12" stroke-width="0" fill="white"></circle>
          <path d="M5 8H18" stroke-width="1.25" stroke-linecap="round" stroke="#09406e"></path>
          <path d="M5 12H18" stroke-width="1.25" stroke-linecap="round" stroke="#09406e"></path>
          <path d="M5 16H18" stroke-width="1.25" stroke-linecap="round" stroke="#09406e"></path>
        </svg>
      </a>
    </div>

    <!-- Truck -->
    <div class="
              fixed
              left-0
              flex
              h-14 min-h-fit
              w-14 min-w-14 
              top-44
              bg-sky-900 
              rounded-r-full 
              ">
      <a class="flex ml-auto p-1 drop-shadow-sm" href="#">
        <!-- Truck svg -->
        <svg class="p-2" fill="#ffffff" viewBox="0 -30.87 122.88 122.88" version="1.1" id="Layer_1"
          xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
          style="enable-background:new 255 0 122.88 61.14" xml:space="preserve">
          <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
          <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
          <g id="SVGRepo_iconCarrier">
            <style type="text/css">
              .st0 {
                fill-rule: evenodd;
                clip-rule: evenodd;
              }
            </style>
            <g>
              <path class="st0"
                d="M105.01,40.54c-5.7,0-10.3,4.63-10.3,10.3c0,5.7,4.63,10.3,10.3,10.3c5.7,0,10.3-4.63,10.3-10.3 C115.31,45.14,110.68,40.54,105.01,40.54L105.01,40.54z M61.86,41.46c-5.2,0-9.38,4.22-9.38,9.38c0,5.2,4.22,9.38,9.38,9.38 c5.2,0,9.38-4.22,9.38-9.38C71.24,45.64,67.02,41.46,61.86,41.46L61.86,41.46z M61.86,47.23c-1.99,0-3.61,1.62-3.61,3.61 s1.62,3.61,3.61,3.61c1.99,0,3.61-1.62,3.61-3.61S63.85,47.23,61.86,47.23L61.86,47.23z M24.11,41.46c-5.2,0-9.38,4.22-9.38,9.38 c0,5.2,4.22,9.38,9.38,9.38c5.2,0,9.38-4.22,9.38-9.38C33.5,45.64,29.28,41.46,24.11,41.46L24.11,41.46z M24.11,47.23 c-1.99,0-3.61,1.62-3.61,3.61s1.62,3.61,3.61,3.61c1.99,0,3.61-1.62,3.61-3.61S26.11,47.23,24.11,47.23L24.11,47.23z M47.37,53.53 H38.1v-3.01h9.27V53.53L47.37,53.53z M10.46,53.53H5.63c-1.55,0-2.95-0.66-3.96-1.71c-1.01-1.05-1.65-2.5-1.65-4.02V8.06 c0-2.44-0.36-4.44,1.62-6.42C2.66,0.63,4.05,0,5.6,0h73.32c1.55,0,2.95,0.63,3.96,1.65c1.01,1.01,1.65,2.41,1.65,3.96l0,7.26 l10.27,0.07l3.62,0.02l0,0c0.73,0.79,1.4,1.6,2.01,2.42c2.71,3.64,4.23,7.94,4.52,12.11l16.38,6.27l1.55,16.51h-5.01 c-2.31-18.03-25.03-15.84-25.73,0l-7.61,0v1.74c0,0.86-0.67,1.52-1.52,1.52l-6.69,0v-3.04h5.16V5.61c0-0.7-0.28-1.33-0.76-1.81 c-0.48-0.48-1.11-0.76-1.81-0.76H5.6c-0.7,0-1.33,0.29-1.81,0.76C2.76,4.77,3.07,6.43,3.07,7.7v40.1c0,0.73,0.32,1.43,0.79,1.93 c0.48,0.48,1.08,0.79,1.77,0.79h4.82V53.53L10.46,53.53z M94.46,17.89l-5.83-0.09v9.69h11.02C99.12,23.98,97.49,20.9,94.46,17.89 L94.46,17.89z M105.01,46.88c-2.19,0-3.96,1.77-3.96,3.96c0,2.19,1.77,3.96,3.96,3.96c2.19,0,3.96-1.77,3.96-3.96 C108.97,48.65,107.2,46.88,105.01,46.88L105.01,46.88z">
              </path>
            </g>
          </g>
        </svg>
      </a>
    </div>

    <!-- Fuel -->
    <div class="
              fixed
              left-0
              flex
              h-14 min-h-fit
              w-14 min-w-14 
              top-60
              bg-sky-900 
              rounded-r-full 
              ">
      <a class="flex ml-auto p-1 drop-shadow-sm" href="#">
        <!-- fuel svg -->
        <svg class="p-2" fill="#ffffff" viewBox="0 -29 122.88 122.88" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg"
          xmlns:xlink="http://www.w3.org/1999/xlink" style="enable-background:new 0 0 122.88 64.87"
          xml:space="preserve">
          <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
          <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
          <g id="SVGRepo_iconCarrier">
            <style type="text/css">
              .st0 {
                fill-rule: evenodd;
                clip-rule: evenodd;
              }
            </style>
            <g>
              <path class="st0"
                d="M6.48,10.34C4.99,10.62,3.2,6.72,4.61,6.08c22.22-12.79,24.46-2.2,46.46,2.86l0.28-0.79 c0.7-1.94,0.67-1.34,2.89-0.72l1.07,0.3c3.66,1.02,2.04,0.73,5-1.16C66.99,2.31,77.1,3.3,83.85,7.65c5.85,3.77,6.3,6.93,7.69,13.05 c1.28,5.61,19.56,22.09,31.34,33.11l-5.56,5.78l-7.73-8.05l-7.92,8.71c-2.14,2.35-3.54,4.85-7.06,4.6c-2.38-0.17-8.58-3.74-11-4.94 l-10.13-5.03c-1.82-1.73-2.68-3.98-2.5-6.81c-2.65,0.34-4.93-0.29-6.87-1.84c-6.98-5.57-3.33-9.32-4.3-15.42 c-0.07-0.42-0.15-0.85-0.26-1.27c-1.58-6.4-5.08-8.43-10.19-10.77c-1.62-0.74-1.45-0.35-0.83-2.03l0.25-0.68 C29.65,11.09,25.52,1.22,6.48,10.34L6.48,10.34z M4.04,10.16c1.01,4.47,4.04,6.7,4.04,8.93c0,2.23-1.01,4.47-4.04,4.47 C1.01,23.56,0,21.33,0,19.09C0,16.86,3.03,14.63,4.04,10.16L4.04,10.16z M77.87,41.66c0.36-1.19,0.21-2.54-0.9-3.61l4.29-3.59 c1.67-1.19,3.54-1.74,5.65-1.48c5.76,0.71,14.38,10.65,18.82,14.73l-8.59,9.72C92.13,50.22,86.47,40.79,77.87,41.66L77.87,41.66z M76.24,46.45c0.49-0.35,1.07-0.51,1.75-0.48l4.15,7.72C80.1,53.03,71.85,49.62,76.24,46.45L76.24,46.45z M81.53,45.17 c2.98,1.46,7.29,6.6,11.54,12.06c0.79,0.64-0.1,2.51-2.09,0.97l-2.61-1.39C83.54,54.08,82.99,51.5,81.53,45.17L81.53,45.17z">
              </path>
            </g>
          </g>
        </svg>
      </a>
    </div>



    {% endif %}
</nav>

<!-- ciclo por los language.code y cuando encuentre el código: si es el 'ultimo' poner el primero, si no, index+1 -->

{% block scripts %}
{% endblock %}